

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>7. Data Exploration &mdash; Learning Apache Spark with Python v1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="static/icon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Learning Apache Spark with Python v1.0 documentation" href="index.html"/>
        <link rel="next" title="8. Regression" href="regression.html"/>
        <link rel="prev" title="6. Statistics Preliminary" href="stats.html"/>
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-168290-9']);
  _gaq.push(['_trackPageview']);
</script>


  
  <script src="static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Learning Apache Spark with Python
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">1. Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="why.html">2. Why Spark with Python ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">3. Configure Running Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">4. An Introduction to Apache Spark</a></li>
<li class="toctree-l1"><a class="reference internal" href="rdd.html">5. Programming with RDDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="stats.html">6. Statistics Preliminary</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">7. Data Exploration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#univariate-analysis">7.1. Univariate Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#numerical-variables">7.1.1. Numerical Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#categorical-variables">7.1.2. Categorical Variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#multivariate-analysis">7.2. Multivariate Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#numerical-v-s-numerical">7.2.1. Numerical V.S. Numerical</a></li>
<li class="toctree-l3"><a class="reference internal" href="#categorical-v-s-categorical">7.2.2. Categorical V.S. Categorical</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numerical-v-s-categorical">7.2.3. Numerical V.S. Categorical</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="regression.html">8. Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="reg.html">9. Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="classification.html">10. Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">11. Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="rfm.html">12. RFM Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="textmining.html">13. Text Mining</a></li>
<li class="toctree-l1"><a class="reference internal" href="socialnetwork.html">14. Social Network Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="als.html">15. ALS: Stock Portfolio Recommendations</a></li>
<li class="toctree-l1"><a class="reference internal" href="mc.html">16. Monte Carlo Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="mcmc.html">17. Markov Chain Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="fnn.html">18. Neural Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="pack.html">19. My PySpark Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="cheat.html">20. My Cheat Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">21. Main Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Learning Apache Spark with Python</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>7. Data Exploration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="data-exploration">
<span id="exploration"></span><h1>7. Data Exploration<a class="headerlink" href="#data-exploration" title="Permalink to this headline">¶</a></h1>
<div class="admonition-chinese-proverb admonition">
<p class="first admonition-title">Chinese proverb</p>
<p class="last"><strong>A journey of a thousand miles begins with a single step</strong>
– idiom, from Laozi.</p>
</div>
<p>I wouldn&#8217;t say that understanding your dataset is the most difficult thing in data science, but it is really important and time-consuming. Data Exploration is about describing the data by means of statistical and visualization techniques. We explore data in order to understand the features and bring important features to our models.</p>
<div class="section" id="univariate-analysis">
<h2>7.1. Univariate Analysis<a class="headerlink" href="#univariate-analysis" title="Permalink to this headline">¶</a></h2>
<p>In mathematics, univariate refers to an expression, equation, function or polynomial of only one variable.  “Uni” means “one”, so in other words your data has only one variable. So you do not need to deal with the causes or relationships in this step. Univariate analysis takes data, summarizes that variables (attributes) one by one and finds patterns in the data.</p>
<p>There are many ways that can describe patterns found in univariate data include central tendency (mean, mode and median) and dispersion: range, variance, maximum, minimum, quartiles (including the interquartile range), coefficient of variation and standard deviation. You also have several options for visualizing and describing data with univariate data. Such as <code class="docutils literal"><span class="pre">frequency</span> <span class="pre">Distribution</span> <span class="pre">Tables</span></code>, <code class="docutils literal"><span class="pre">bar</span> <span class="pre">Charts</span></code>, <code class="docutils literal"><span class="pre">histograms</span></code>, <code class="docutils literal"><span class="pre">frequency</span> <span class="pre">Polygons</span></code>, <code class="docutils literal"><span class="pre">pie</span> <span class="pre">Charts</span></code>.</p>
<p>The variable could be either categorical or numerical, I will demostrate the different statistical and visulization techniques to investigate each type of the variable.</p>
<ul class="simple">
<li>The Jupyter notebook can be download from <a class="reference external" href="static/Data_exploration.ipynb">Data Exploration</a>.</li>
<li>The data can be downloaf from <a class="reference external" href="static/german_credit.csv">German Credit</a>.</li>
</ul>
<div class="section" id="numerical-variables">
<h3>7.1.1. Numerical Variables<a class="headerlink" href="#numerical-variables" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Describe</li>
</ul>
<p>The <code class="docutils literal"><span class="pre">desctibe</span></code> function in <code class="docutils literal"><span class="pre">pandas</span></code> and <code class="docutils literal"><span class="pre">spark</span></code> will give us most of the statistical results, such as <code class="docutils literal"><span class="pre">min</span></code>, <code class="docutils literal"><span class="pre">median</span></code>, <code class="docutils literal"><span class="pre">max</span></code>, <code class="docutils literal"><span class="pre">quartiles</span></code> and <code class="docutils literal"><span class="pre">standard</span> <span class="pre">deviation</span></code>. With the help of the user defined function, you can get even more statistical results.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># selected varables for the demonstration</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Account Balance&#39;</span><span class="p">,</span><span class="s1">&#39;No of dependents&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">num_cols</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">+-------+------------------+-------------------+</span>
<span class="o">|</span><span class="n">summary</span><span class="o">|</span>   <span class="n">Account</span> <span class="n">Balance</span><span class="o">|</span>   <span class="n">No</span> <span class="n">of</span> <span class="n">dependents</span><span class="o">|</span>
<span class="o">+-------+------------------+-------------------+</span>
<span class="o">|</span>  <span class="n">count</span><span class="o">|</span>              <span class="mi">1000</span><span class="o">|</span>               <span class="mi">1000</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">mean</span><span class="o">|</span>             <span class="mf">2.577</span><span class="o">|</span>              <span class="mf">1.155</span><span class="o">|</span>
<span class="o">|</span> <span class="n">stddev</span><span class="o">|</span><span class="mf">1.2576377271108936</span><span class="o">|</span><span class="mf">0.36208577175319395</span><span class="o">|</span>
<span class="o">|</span>    <span class="nb">min</span><span class="o">|</span>                 <span class="mi">1</span><span class="o">|</span>                  <span class="mi">1</span><span class="o">|</span>
<span class="o">|</span>    <span class="nb">max</span><span class="o">|</span>                 <span class="mi">4</span><span class="o">|</span>                  <span class="mi">2</span><span class="o">|</span>
<span class="o">+-------+------------------+-------------------+</span>
</pre></div>
</div>
<p>You may find out that the default function in PySpark does not include the quartiles. The following function will help you to get the same
results in Pandas</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">describe_pd</span><span class="p">(</span><span class="n">df_in</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">style</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to union the basic stats results and deciles</span>
<span class="sd">    :param df_in: the input dataframe</span>
<span class="sd">    :param columns: the cloumn name list of the numerical variable</span>
<span class="sd">    :param style: the display style</span>

<span class="sd">    :return : the numerical describe info. of the input dataframe</span>

<span class="sd">    :author: MIng Chen and Wenqiang Feng</span>
<span class="sd">    :email:  von198@gmail.com</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">percentiles</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">percentiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="n">percs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_in</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">(),</span> <span class="n">percentiles</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">])</span>
    <span class="n">percs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">percs</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">percs</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">percentiles</span><span class="p">]</span>

    <span class="n">spark_describe</span> <span class="o">=</span> <span class="n">df_in</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
    <span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">spark_describe</span><span class="p">,</span> <span class="n">percs</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">new_df</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_df</span><span class="p">[[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">describe_pd</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">num_cols</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">+-------+------------------+-----------------+</span>
<span class="o">|</span><span class="n">summary</span><span class="o">|</span>   <span class="n">Account</span> <span class="n">Balance</span><span class="o">|</span> <span class="n">No</span> <span class="n">of</span> <span class="n">dependents</span><span class="o">|</span>
<span class="o">+-------+------------------+-----------------+</span>
<span class="o">|</span>  <span class="n">count</span><span class="o">|</span>            <span class="mf">1000.0</span><span class="o">|</span>           <span class="mf">1000.0</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">mean</span><span class="o">|</span>             <span class="mf">2.577</span><span class="o">|</span>            <span class="mf">1.155</span><span class="o">|</span>
<span class="o">|</span> <span class="n">stddev</span><span class="o">|</span><span class="mf">1.2576377271108936</span><span class="o">|</span><span class="mf">0.362085771753194</span><span class="o">|</span>
<span class="o">|</span>    <span class="nb">min</span><span class="o">|</span>               <span class="mf">1.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="nb">max</span><span class="o">|</span>               <span class="mf">4.0</span><span class="o">|</span>              <span class="mf">2.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">25</span><span class="o">%|</span>               <span class="mf">1.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">50</span><span class="o">%|</span>               <span class="mf">2.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">75</span><span class="o">%|</span>               <span class="mf">4.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">+-------+------------------+-----------------+</span>
</pre></div>
</div>
<p>Sometimes, because of the confidential data issues, you can not deliver the real data and your clients may ask more statistical results, such as <code class="docutils literal"><span class="pre">deciles</span></code>. You can apply the follwing function to achieve it.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">describe_pd</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">num_cols</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">+-------+------------------+-----------------+</span>
<span class="o">|</span><span class="n">summary</span><span class="o">|</span>   <span class="n">Account</span> <span class="n">Balance</span><span class="o">|</span> <span class="n">No</span> <span class="n">of</span> <span class="n">dependents</span><span class="o">|</span>
<span class="o">+-------+------------------+-----------------+</span>
<span class="o">|</span>  <span class="n">count</span><span class="o">|</span>            <span class="mf">1000.0</span><span class="o">|</span>           <span class="mf">1000.0</span><span class="o">|</span>
<span class="o">|</span>   <span class="n">mean</span><span class="o">|</span>             <span class="mf">2.577</span><span class="o">|</span>            <span class="mf">1.155</span><span class="o">|</span>
<span class="o">|</span> <span class="n">stddev</span><span class="o">|</span><span class="mf">1.2576377271108936</span><span class="o">|</span><span class="mf">0.362085771753194</span><span class="o">|</span>
<span class="o">|</span>    <span class="nb">min</span><span class="o">|</span>               <span class="mf">1.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="nb">max</span><span class="o">|</span>               <span class="mf">4.0</span><span class="o">|</span>              <span class="mf">2.0</span><span class="o">|</span>
<span class="o">|</span>     <span class="mi">0</span><span class="o">%|</span>               <span class="mf">1.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">10</span><span class="o">%|</span>               <span class="mf">1.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">20</span><span class="o">%|</span>               <span class="mf">1.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">30</span><span class="o">%|</span>               <span class="mf">2.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">40</span><span class="o">%|</span>               <span class="mf">2.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">50</span><span class="o">%|</span>               <span class="mf">2.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">60</span><span class="o">%|</span>               <span class="mf">3.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">70</span><span class="o">%|</span>               <span class="mf">4.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">80</span><span class="o">%|</span>               <span class="mf">4.0</span><span class="o">|</span>              <span class="mf">1.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">90</span><span class="o">%|</span>               <span class="mf">4.0</span><span class="o">|</span>              <span class="mf">2.0</span><span class="o">|</span>
<span class="o">|</span>   <span class="mi">100</span><span class="o">%|</span>               <span class="mf">4.0</span><span class="o">|</span>              <span class="mf">2.0</span><span class="o">|</span>
<span class="o">+-------+------------------+-----------------+</span>
</pre></div>
</div>
<ul>
<li><p class="first">Skewness and Kurtosis</p>
<p>This subsection comes from Wikipedia <a class="reference external" href="https://en.wikipedia.org/wiki/Skewness">Skewness</a>.</p>
<p>In probability theory and statistics, skewness is a measure of the asymmetry of the probability distribution of a real-valued random variable about its mean. The skewness value can be positive or negative, or undefined.For a unimodal distribution, negative skew commonly indicates that the tail is on the left side of the distribution, and positive skew indicates that the tail is on the right.</p>
<p>Consider the two distributions in the figure just below. Within each graph, the values on the right side of the distribution taper differently from the values on the left side. These tapering sides are called tails, and they provide a visual means to determine which of the two kinds of skewness a distribution has:</p>
<ol class="arabic simple">
<li>negative skew: The left tail is longer; the mass of the distribution is concentrated on the right of the figure. The distribution is said to be left-skewed, left-tailed, or skewed to the left, despite the fact that the curve itself appears to be skewed or leaning to the right; left instead refers to the left tail being drawn out and, often, the mean being skewed to the left of a typical center of the data. A left-skewed distribution usually appears as a right-leaning curve.</li>
<li>positive skew: The right tail is longer; the mass of the distribution is concentrated on the left of the figure. The distribution is said to be right-skewed, right-tailed, or skewed to the right, despite the fact that the curve itself appears to be skewed or leaning to the left; right instead refers to the right tail being drawn out and, often, the mean being skewed to the right of a typical center of the data. A right-skewed distribution usually appears as a left-leaning curve.</li>
</ol>
<p>This subsection comes from Wikipedia <a class="reference external" href="https://en.wikipedia.org/wiki/Kurtosis">Kurtosis</a>.</p>
<p>In probability theory and statistics, kurtosis (kyrtos or kurtos, meaning &#8220;curved, arching&#8221;) is a measure of the &#8220;tailedness&#8221; of the probability distribution of a real-valued random variable. In a similar way to the concept of skewness, kurtosis is a descriptor of the shape of a probability distribution and, just as for skewness, there are different ways of quantifying it for a theoretical distribution and corresponding ways of estimating it from a sample from a population.</p>
</li>
</ul>
<div class="figure align-center" id="fig-skewed">
<img alt="images/skewed.png" src="images/skewed.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">col</span><span class="p">,</span> <span class="n">skewness</span><span class="p">,</span> <span class="n">kurtosis</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">skewness</span><span class="p">(</span><span class="n">var</span><span class="p">),</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">var</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">+---------------------+---------------------+</span>
<span class="o">|</span><span class="n">skewness</span><span class="p">(</span><span class="n">Age</span> <span class="p">(</span><span class="n">years</span><span class="p">))</span><span class="o">|</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">Age</span> <span class="p">(</span><span class="n">years</span><span class="p">))</span><span class="o">|</span>
<span class="o">+---------------------+---------------------+</span>
<span class="o">|</span>   <span class="mf">1.0231743160548064</span><span class="o">|</span>   <span class="mf">0.6114371688367672</span><span class="o">|</span>
<span class="o">+---------------------+---------------------+</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><strong>Sometimes the statistics can be misleading!</strong></p>
</div>
<p>F. J. Anscombe once said that make both calculations and graphs. Both sorts of output should be studied; each will contribute to understanding.
These 13 datasets in Figure <a class="reference internal" href="#fig-misleading"><span class="std std-ref">Same Stats, Different Graphs</span></a> (the Datasaurus, plus 12 others) each have the same summary statistics (x/y mean, x/y standard deviation, and Pearson&#8217;s correlation) to two decimal places, while being drastically different in appearance. This work describes the technique we developed to create this dataset, and others like it. More details and interesting results can be found in <a class="reference external" href="https://www.autodeskresearch.com/publications/samestats">Same Stats Different Graphs</a>.</p>
<div class="figure align-center" id="id2">
<span id="fig-misleading"></span><img alt="images/misleading.png" src="images/misleading.png" />
<p class="caption"><span class="caption-number">Fig. 7.2 </span><span class="caption-text">Same Stats, Different Graphs</span></p>
</div>
<ul class="simple">
<li>Histogram</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><strong>Histograms are often confused with Bar graphs!</strong></p>
</div>
<p>The fundamental difference between histogram and bar graph will help you to identify the two easily is that there are gaps between bars in a bar graph but in the histogram, the bars are adjacent to each other. The interested reader is referred to <a class="reference external" href="https://keydifferences.com/difference-between-histogram-and-bar-graph.html">Difference Between Histogram and Bar Graph</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;Age (years)&#39;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="c1"># the histogram of the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span>
         <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">100.</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;percentage&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">var</span><span class="o">+</span><span class="s2">&quot;.pdf&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-his-s">
<img alt="images/his_s.png" src="images/his_s.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;Age (years)&#39;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>


<span class="c1">########################################################################</span>
<span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bins</span><span class="p">,</span>
                               <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">100.</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="c1"># make the histogram</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Plot the histogram heights against integers on the x axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hist</span><span class="p">)),</span><span class="n">hist</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">ec</span> <span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">)</span>
<span class="c1"># # Set the ticks to the middle of the bars</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">0.5</span><span class="o">+</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hist</span><span class="p">)])</span>
<span class="c1"># Set the xticklabels to a string that tells us what the bin edges were</span>
<span class="n">labels</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hist</span><span class="p">)]</span>
<span class="n">labels</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;percentage&#39;</span><span class="p">)</span>

<span class="c1">########################################################################</span>

<span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bins</span><span class="p">)</span> <span class="c1"># make the histogram</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># Plot the histogram heights against integers on the x axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hist</span><span class="p">)),</span><span class="n">hist</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">ec</span> <span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">)</span>

<span class="c1"># # Set the ticks to the middle of the bars</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">0.5</span><span class="o">+</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hist</span><span class="p">)])</span>

<span class="c1"># Set the xticklabels to a string that tells us what the bin edges were</span>
<span class="n">labels</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hist</span><span class="p">)]</span>
<span class="n">labels</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Histogram of {}: Left with percentage output;Right with count output&#39;</span>
             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">var</span><span class="o">+</span><span class="s2">&quot;.pdf&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-his-d">
<img alt="images/his_d.png" src="images/his_d.png" />
</div>
<p>Sometimes, some people will ask you to plot the unequal width (invalid argument for histogram) of the bars. YOu can still achieve it by the follwing trick.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;Credit Amount&#39;</span>
<span class="n">plot_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">var</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>
<span class="n">x</span><span class="o">=</span> <span class="n">plot_data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>

<span class="n">bins</span> <span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">700</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">900</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">3000</span><span class="p">,</span><span class="mi">4000</span><span class="p">,</span><span class="mi">5000</span><span class="p">,</span><span class="mi">6000</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">25000</span><span class="p">]</span>

<span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bins</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">100.</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="c1"># make the histogram</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Plot the histogram heights against integers on the x axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hist</span><span class="p">)),</span><span class="n">hist</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">ec</span> <span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gold&#39;</span><span class="p">)</span>

<span class="c1"># # Set the ticks to the middle of the bars</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">0.5</span><span class="o">+</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hist</span><span class="p">)])</span>

<span class="c1"># Set the xticklabels to a string that tells us what the bin edges were</span>
<span class="c1">#labels =[&#39;{}k&#39;.format(int(bins[i+1]/1000)) for i,j in enumerate(hist)]</span>
<span class="n">labels</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hist</span><span class="p">)]</span>
<span class="n">labels</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="c1">#plt.text(-0.6, -1.4,&#39;0&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;percentage&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-vis4">
<img alt="images/unequal.png" src="images/unequal.png" />
</div>
<ul class="simple">
<li>Box plot and violin plot</li>
</ul>
<p>Note that although violin plots are closely related to Tukey&#8217;s (1977) box plots, the violin plot can show more information than box plot. When we perform an exploratory analysis, nothing about the samples could be known. So the distribution of the samples can not be assumed to a normal distribution and usually when you get a big data, the normal distribution will show some out liars in box plot.</p>
<p>However, the violin plots are potentially misleading for smaller sample sizes, where the density plots can appear to show interesting features (and group-differences therein) even when produced for standard normal data. Some poster suggested the sample size should larger that 250. The sample sizes (e.g. n&gt;250 or ideally even larger), where the kernel density plots provide a reasonably accurate representation of the distributions, potentially showing nuances such as bimodality or other forms of non-normality that would be invisible or less clear in box plots. More details can be found in <a class="reference external" href="https://figshare.com/articles/A_simple_comparison_of_box_plots_and_violin_plots/1544525">A simple comparison of box plots and violin plots</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">var</span><span class="p">)</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-box-vio">
<img alt="images/box_vio.png" src="images/box_vio.png" />
</div>
</div>
<div class="section" id="categorical-variables">
<h3>7.1.2. Categorical Variables<a class="headerlink" href="#categorical-variables" title="Permalink to this headline">¶</a></h3>
<p>Compared with the numerical variables, the categorical variables are much more easier to do the exploration.</p>
<ul class="simple">
<li>Frequency table</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">functions</span> <span class="k">as</span> <span class="n">F</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">rank</span><span class="p">,</span><span class="nb">sum</span><span class="p">,</span><span class="n">col</span>
<span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">Window</span>

<span class="n">window</span> <span class="o">=</span> <span class="n">Window</span><span class="o">.</span><span class="n">rowsBetween</span><span class="p">(</span><span class="n">Window</span><span class="o">.</span><span class="n">unboundedPreceding</span><span class="p">,</span><span class="n">Window</span><span class="o">.</span><span class="n">unboundedFollowing</span><span class="p">)</span>
<span class="c1"># withColumn(&#39;Percent %&#39;,F.format_string(&quot;%5.0f%%\n&quot;,col(&#39;Credit_num&#39;)*100/col(&#39;total&#39;))).\</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;age_class&#39;</span><span class="p">,</span><span class="s1">&#39;Credit Amount&#39;</span><span class="p">])</span><span class="o">.</span>\
   <span class="n">groupBy</span><span class="p">(</span><span class="s1">&#39;age_class&#39;</span><span class="p">)</span><span class="o">.</span>\
   <span class="n">agg</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;Credit Amount&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;Credit_num&#39;</span><span class="p">),</span>
       <span class="n">F</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;Credit Amount&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;Credit_avg&#39;</span><span class="p">),</span>
       <span class="n">F</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s1">&#39;Credit Amount&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;Credit_min&#39;</span><span class="p">),</span>
       <span class="n">F</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;Credit Amount&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;Credit_max&#39;</span><span class="p">))</span><span class="o">.</span>\
   <span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;total&#39;</span><span class="p">,</span><span class="nb">sum</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;Credit_num&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">window</span><span class="p">))</span><span class="o">.</span>\
   <span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;Percent&#39;</span><span class="p">,</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;Credit_num&#39;</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;total&#39;</span><span class="p">))</span><span class="o">.</span>\
   <span class="n">drop</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;total&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">+---------+----------+------------------+----------+----------+-------+</span>
<span class="o">|</span><span class="n">age_class</span><span class="o">|</span><span class="n">Credit_num</span><span class="o">|</span>        <span class="n">Credit_avg</span><span class="o">|</span><span class="n">Credit_min</span><span class="o">|</span><span class="n">Credit_max</span><span class="o">|</span><span class="n">Percent</span><span class="o">|</span>
<span class="o">+---------+----------+------------------+----------+----------+-------+</span>
<span class="o">|</span>    <span class="mi">45</span><span class="o">-</span><span class="mi">54</span><span class="o">|</span>       <span class="mi">120</span><span class="o">|</span><span class="mf">3183.0666666666666</span><span class="o">|</span>       <span class="mi">338</span><span class="o">|</span>     <span class="mi">12612</span><span class="o">|</span>   <span class="mf">12.0</span><span class="o">|</span>
<span class="o">|</span>      <span class="o">&lt;</span><span class="mi">25</span><span class="o">|</span>       <span class="mi">150</span><span class="o">|</span> <span class="mf">2970.733333333333</span><span class="o">|</span>       <span class="mi">276</span><span class="o">|</span>     <span class="mi">15672</span><span class="o">|</span>   <span class="mf">15.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">55</span><span class="o">-</span><span class="mi">64</span><span class="o">|</span>        <span class="mi">56</span><span class="o">|</span> <span class="mf">3493.660714285714</span><span class="o">|</span>       <span class="mi">385</span><span class="o">|</span>     <span class="mi">15945</span><span class="o">|</span>    <span class="mf">5.6</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">35</span><span class="o">-</span><span class="mi">44</span><span class="o">|</span>       <span class="mi">254</span><span class="o">|</span> <span class="mf">3403.771653543307</span><span class="o">|</span>       <span class="mi">250</span><span class="o">|</span>     <span class="mi">15857</span><span class="o">|</span>   <span class="mf">25.4</span><span class="o">|</span>
<span class="o">|</span>    <span class="mi">25</span><span class="o">-</span><span class="mi">34</span><span class="o">|</span>       <span class="mi">397</span><span class="o">|</span> <span class="mf">3298.823677581864</span><span class="o">|</span>       <span class="mi">343</span><span class="o">|</span>     <span class="mi">18424</span><span class="o">|</span>   <span class="mf">39.7</span><span class="o">|</span>
<span class="o">|</span>      <span class="mi">65</span><span class="o">+|</span>        <span class="mi">23</span><span class="o">|</span><span class="mf">3210.1739130434785</span><span class="o">|</span>       <span class="mi">571</span><span class="o">|</span>     <span class="mi">14896</span><span class="o">|</span>    <span class="mf">2.3</span><span class="o">|</span>
<span class="o">+---------+----------+------------------+----------+----------+-------+</span>
</pre></div>
</div>
<ul class="simple">
<li>Pie plot</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Data to plot</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">age_class</span>
<span class="n">sizes</span> <span class="o">=</span>  <span class="n">plot_data</span><span class="o">.</span><span class="n">Percent</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span> <span class="s1">&#39;yellowgreen&#39;</span><span class="p">,</span> <span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;lightskyblue&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">]</span>
<span class="n">explode</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># explode 1st slice</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">explode</span><span class="o">=</span><span class="n">explode</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-vis1">
<img alt="images/pie.png" src="images/pie.png" />
</div>
<ul class="simple">
<li>Bar plot</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">age_class</span>
<span class="n">missing</span> <span class="o">=</span> <span class="n">plot_data</span><span class="o">.</span><span class="n">Percent</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">missing</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;missing&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;percentage&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-vis2">
<img alt="images/bar.png" src="images/bar.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;missing&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;25&#39;</span><span class="p">,</span> <span class="s1">&#39;25-34&#39;</span><span class="p">,</span> <span class="s1">&#39;35-44&#39;</span><span class="p">,</span> <span class="s1">&#39;45-54&#39;</span><span class="p">,</span><span class="s1">&#39;55-64&#39;</span><span class="p">,</span><span class="s1">&#39;65+&#39;</span><span class="p">]</span>
<span class="n">missing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.000095</span><span class="p">,</span> <span class="mf">0.024830</span><span class="p">,</span> <span class="mf">0.028665</span><span class="p">,</span> <span class="mf">0.029477</span><span class="p">,</span> <span class="mf">0.031918</span><span class="p">,</span><span class="mf">0.037073</span><span class="p">,</span><span class="mf">0.026699</span><span class="p">])</span>
<span class="n">man</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.000147</span><span class="p">,</span> <span class="mf">0.036311</span><span class="p">,</span> <span class="mf">0.038684</span><span class="p">,</span> <span class="mf">0.044761</span><span class="p">,</span> <span class="mf">0.051269</span><span class="p">,</span> <span class="mf">0.059542</span><span class="p">,</span> <span class="mf">0.054259</span><span class="p">])</span>
<span class="n">women</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.004035</span><span class="p">,</span> <span class="mf">0.032935</span><span class="p">,</span> <span class="mf">0.035351</span><span class="p">,</span> <span class="mf">0.041778</span><span class="p">,</span> <span class="mf">0.048437</span><span class="p">,</span> <span class="mf">0.056236</span><span class="p">,</span><span class="mf">0.048091</span><span class="p">])</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">women</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;women&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">man</span><span class="o">+</span><span class="n">missing</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">man</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;man&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;silver&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">missing</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">missing</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;missing&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#CD853F&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;percentage&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;demo&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-vis3">
<img alt="images/stacked.png" src="images/stacked.png" />
</div>
</div>
</div>
<div class="section" id="multivariate-analysis">
<h2>7.2. Multivariate Analysis<a class="headerlink" href="#multivariate-analysis" title="Permalink to this headline">¶</a></h2>
<p>In this section, I will only demostrate the bivariate analysis. Since the multivariate analysis is the generation of the bivariate.</p>
<div class="section" id="numerical-v-s-numerical">
<h3>7.2.1. Numerical V.S. Numerical<a class="headerlink" href="#numerical-v-s-numerical" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Correlation matrix</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.mllib.stat</span> <span class="kn">import</span> <span class="n">Statistics</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">corr_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">num_cols</span><span class="p">)</span>

<span class="n">col_names</span> <span class="o">=</span> <span class="n">corr_data</span><span class="o">.</span><span class="n">columns</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">corr_data</span><span class="o">.</span><span class="n">rdd</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">:])</span>
<span class="n">corr_mat</span><span class="o">=</span><span class="n">Statistics</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;pearson&quot;</span><span class="p">)</span>
<span class="n">corr_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">corr_mat</span><span class="p">)</span>
<span class="n">corr_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">corr_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">col_names</span><span class="p">,</span> <span class="n">col_names</span>

<span class="k">print</span><span class="p">(</span><span class="n">corr_df</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">+--------------------+--------------------+</span>
<span class="o">|</span>     <span class="n">Account</span> <span class="n">Balance</span><span class="o">|</span>    <span class="n">No</span> <span class="n">of</span> <span class="n">dependents</span><span class="o">|</span>
<span class="o">+--------------------+--------------------+</span>
<span class="o">|</span>                 <span class="mf">1.0</span><span class="o">|-</span><span class="mf">0.01414542650320914</span><span class="o">|</span>
<span class="o">|-</span><span class="mf">0.01414542650320914</span><span class="o">|</span>                 <span class="mf">1.0</span><span class="o">|</span>
<span class="o">+--------------------+--------------------+</span>
</pre></div>
</div>
<ul class="simple">
<li>Scatter Plot</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;iris&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;species&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-pair-plot">
<img alt="images/pairplot.png" src="images/pairplot.png" />
</div>
</div>
<div class="section" id="categorical-v-s-categorical">
<h3>7.2.2. Categorical V.S. Categorical<a class="headerlink" href="#categorical-v-s-categorical" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Pearson’s Chi-squared test</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><code class="docutils literal"><span class="pre">pyspark.ml.stat</span></code> is only available in Spark 2.4.0.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.ml.linalg</span> <span class="kn">import</span> <span class="n">Vectors</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.stat</span> <span class="kn">import</span> <span class="n">ChiSquareTest</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Vectors</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Vectors</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">)),</span>
        <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Vectors</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Vectors</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Vectors</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">)),</span>
        <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Vectors</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">))]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">])</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">ChiSquareTest</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;pValues: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">pValues</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;degreesOfFreedom: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">degreesOfFreedom</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;statistics: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">statistics</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">pValues</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.687289278791</span><span class="p">,</span><span class="mf">0.682270330336</span><span class="p">]</span>
<span class="n">degreesOfFreedom</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">statistics</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">1.5</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li>Cross table</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">stat</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="s2">&quot;age_class&quot;</span><span class="p">,</span> <span class="s2">&quot;Occupation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">+--------------------+---+---+---+---+</span>
<span class="o">|</span><span class="n">age_class_Occupation</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span>  <span class="mi">2</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>  <span class="mi">4</span><span class="o">|</span>
<span class="o">+--------------------+---+---+---+---+</span>
<span class="o">|</span>                 <span class="o">&lt;</span><span class="mi">25</span><span class="o">|</span>  <span class="mi">4</span><span class="o">|</span> <span class="mi">34</span><span class="o">|</span><span class="mi">108</span><span class="o">|</span>  <span class="mi">4</span><span class="o">|</span>
<span class="o">|</span>               <span class="mi">55</span><span class="o">-</span><span class="mi">64</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span> <span class="mi">15</span><span class="o">|</span> <span class="mi">31</span><span class="o">|</span>  <span class="mi">9</span><span class="o">|</span>
<span class="o">|</span>               <span class="mi">25</span><span class="o">-</span><span class="mi">34</span><span class="o">|</span>  <span class="mi">7</span><span class="o">|</span> <span class="mi">61</span><span class="o">|</span><span class="mi">269</span><span class="o">|</span> <span class="mi">60</span><span class="o">|</span>
<span class="o">|</span>               <span class="mi">35</span><span class="o">-</span><span class="mi">44</span><span class="o">|</span>  <span class="mi">4</span><span class="o">|</span> <span class="mi">58</span><span class="o">|</span><span class="mi">143</span><span class="o">|</span> <span class="mi">49</span><span class="o">|</span>
<span class="o">|</span>                 <span class="mi">65</span><span class="o">+|</span>  <span class="mi">5</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>  <span class="mi">6</span><span class="o">|</span>  <span class="mi">9</span><span class="o">|</span>
<span class="o">|</span>               <span class="mi">45</span><span class="o">-</span><span class="mi">54</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span> <span class="mi">29</span><span class="o">|</span> <span class="mi">73</span><span class="o">|</span> <span class="mi">17</span><span class="o">|</span>
<span class="o">+--------------------+---+---+---+---+</span>
</pre></div>
</div>
<ul class="simple">
<li>Stacked plot</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;missing&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;25&#39;</span><span class="p">,</span> <span class="s1">&#39;25-34&#39;</span><span class="p">,</span> <span class="s1">&#39;35-44&#39;</span><span class="p">,</span> <span class="s1">&#39;45-54&#39;</span><span class="p">,</span><span class="s1">&#39;55-64&#39;</span><span class="p">,</span><span class="s1">&#39;65+&#39;</span><span class="p">]</span>
<span class="n">missing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.000095</span><span class="p">,</span> <span class="mf">0.024830</span><span class="p">,</span> <span class="mf">0.028665</span><span class="p">,</span> <span class="mf">0.029477</span><span class="p">,</span> <span class="mf">0.031918</span><span class="p">,</span><span class="mf">0.037073</span><span class="p">,</span><span class="mf">0.026699</span><span class="p">])</span>
<span class="n">man</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.000147</span><span class="p">,</span> <span class="mf">0.036311</span><span class="p">,</span> <span class="mf">0.038684</span><span class="p">,</span> <span class="mf">0.044761</span><span class="p">,</span> <span class="mf">0.051269</span><span class="p">,</span> <span class="mf">0.059542</span><span class="p">,</span> <span class="mf">0.054259</span><span class="p">])</span>
<span class="n">women</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.004035</span><span class="p">,</span> <span class="mf">0.032935</span><span class="p">,</span> <span class="mf">0.035351</span><span class="p">,</span> <span class="mf">0.041778</span><span class="p">,</span> <span class="mf">0.048437</span><span class="p">,</span> <span class="mf">0.056236</span><span class="p">,</span><span class="mf">0.048091</span><span class="p">])</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">women</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;women&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">man</span><span class="o">+</span><span class="n">missing</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">man</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;man&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;silver&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">missing</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">missing</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;missing&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#CD853F&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;percentage&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;demo&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center">
<img alt="images/stacked.png" src="images/stacked.png" />
</div>
</div>
<div class="section" id="numerical-v-s-categorical">
<h3>7.2.3. Numerical V.S. Categorical<a class="headerlink" href="#numerical-v-s-categorical" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="regression.html" class="btn btn-neutral float-right" title="8. Regression" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="stats.html" class="btn btn-neutral" title="6. Statistics Preliminary" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Wenqiang Feng.
      Last updated on Mar 06, 2019.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'v1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="static/jquery.js"></script>
      <script type="text/javascript" src="static/underscore.js"></script>
      <script type="text/javascript" src="static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>


</body>
</html>